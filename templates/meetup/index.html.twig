{% extends 'base.html.twig' %}

{% block title %}Hello MeetupController!{% endblock %}

{% block body %}
    {{ form_start(form)}}
    {{ form_widget(form) }}
    <button type="submit" name="research_button" value="true">Rechercher</button>
    <table>
        <tr>
            <td>Nom de la sortie</td>
            <td>Date de la sortie</td>
            <td>Clôture</td>
            <td>inscrits/places</td>
            <td>Etat</td>
            <td>Inscrit</td>
            <td>Organisateur</td>
            <td>Actions</td>
        </tr>
        {% set registered = 'false' %}
        {% if meetup_list | length !=0 and meetup_list!=null %}
        {% for meetup in meetup_list %}
            <tr>
                <td>{{ meetup.name }}</td>
                <td>{{ meetup.start | date}}</td>
                <td>{{ meetup.registrationEnd | date}}</td>
                <td>{{ meetup.attendees | length }}/{{ meetup.capacity }}</td>
                <td>{{ meetup.status.value}} </td>
                {% for ma in meetup.attendees %}
                    {% if app.user.id == ma.id %}
                        <td>inscrit</td>
                        {% set registered = 'true' %}
                    {% endif %}
                {% endfor %}
                <td>{{ meetup.coordinator.name}}</td>
                <td>
                    <a href="">Afficher</a>
                    {% if registered == 'false' and meetup.status.name == 'Open'%}
                        <a href="">S'inscrire</a>
                    {% endif %}
                    {% if registered == 'true' and (meetup.status.name == 'Open' or meetup.status.name == 'close') %}
                        <a href="">Se désister</a>
                    {% endif %}
                    {% if (meetup.coordinator == app.user or is_granted('ROLE_ADMINISTRATOR')) and meetup.status.name == 'Open' %}
                        <a href="">Modifier</a>
                    {% endif %}

                </td>
            </tr>
        {% endfor %}
        {% endif %}
    </table>
    <button type="submit" name="create_button" value="true">Créer une sortie</button>
    {{ form_end(form) }}
{% endblock %}
